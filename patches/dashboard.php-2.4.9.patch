# This patch file was generated by NetBeans IDE
# It uses platform neutral UTF-8 encoding and \n newlines.
@@ -30,6 +30,10 @@
 
 require_once dirname(__FILE__).'/include/page_header.php';
 
+require_once dirname(__FILE__).'/dashboard/hook.php';
+$custom_blocks = new CustomDashboard();
+$custom_blocks->addCss($page['type']);
+
 //	VAR		TYPE	OPTIONAL FLAGS	VALIDATION	EXCEPTION
 $fields = array(
 	'groupid' =>		array(T_ZBX_INT, O_OPT, P_SYS,	DB_ID,		null),
@@ -155,6 +159,10 @@
 			$widget = make_discovery_status();
 			$widget->show();
 			break;
+                
+                default:
+                    $custom_blocks->refresh(getRequest('widgetRefresh'));
+                    break;
 	}
 }
 
@@ -505,6 +513,12 @@
 	);
 }
 
+
+
+$custom_blocks->loadAll();
+$custom_blocks->loadWidgets($dashboardGrid);
+$custom_blocks->addToRefreshList($widgetRefreshParams);
+
 // sort dashboard grid
 foreach ($dashboardGrid as $key => $val) {
 	ksort($dashboardGrid[$key]);
